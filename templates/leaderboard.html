<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard - SVKM Typing Test</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <header class="navbar">
        <nav>
            <a href="{{ url_for('main') }}" class="nav-link">Home</a>
            <a href="{{ url_for('leaderboard') }}" class="nav-link active">Leaderboard</a>
            <a href="{{ url_for('about') }}" class="nav-link">About</a>
            <a href="{{ url_for('contact') }}" class="nav-link">Contact</a>
            {% if 'user' in session %}
                <a href="{{ url_for('logout') }}" class="nav-link">Logout</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="nav-link">Login</a>
            {% endif %}
        </nav>
    </header>
    <main>
        <div class="leaderboard-container">
            <h2>Global Leaderboard</h2>
            <div class="filter-controls">
                <label for="college-filter">Filter by College:</label>
                <select id="college-filter" onchange="filterByCollege(this.value)">
                    <option value="all" {% if selected_college == 'all' %}selected{% endif %}>All Colleges</option>
                    <option value="DJ SANGHVI" {% if selected_college == 'DJ SANGHVI' %}selected{% endif %}>DJ Sanghvi</option>
                    <option value="BHAGUBAI" {% if selected_college == 'BHAGUBAI' %}selected{% endif %}>Bhagubai</option>
                    <option value="MPSTME" {% if selected_college == 'MPSTME' %}selected{% endif %}>MPSTME</option>
                </select>
            </div>

            <table id="global-leaderboard">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Name</th>
                        <th>College</th>
                        <th>Best WPM</th>
                        <th>Avg. Accuracy</th>
                        <th>Tests</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in rankings %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ user.name }}</td>
                        <td>{{ user.college }}</td>
                        <td>{{ user.best_wpm|round|int }}</td>
                        <td>{{ "%.1f"|format(user.avg_accuracy) }}%</td>
                        <td>{{ user.tests_taken }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h2>College Leaderboard</h2>
            <select id="college-select">
                <option value="dj">DJ Sanghvi</option>
                <option value="bhagubai">Bhagubai</option>
            </select>
            <table id="college-leaderboard">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Name</th>
                        <th>WPM</th>
                        <th>Accuracy</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dynamic content will be inserted here -->
                </tbody>
            </table>
        </div>
    </main>
    <script>
        function filterByCollege(college) {
            window.location.href = `/leaderboard?college=${encodeURIComponent(college)}`;
        }
    </script>
</body>
</html>